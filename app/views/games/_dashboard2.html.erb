<ul class="dashboard">
  <% dashboard.each do |row| %>
    <li class="dashboard__item--player">
      <span>
        <%= row[:player].name %>
        <% if row[:player].description %>
          <small><%= row[:player].description %></small>
        <% end %>
      </span>
      <% if false && row[:cards].size > 0 %>
        <details <%= 'open' if defined?(open_kills) && open_kills %>>
          <summary><strong><%= row[:cards].size %></strong> kills <%= 'ðŸ’€' * row[:cards].size %></summary>
          <ul>
            <% row[:cards].each do |card| %>
              <li class="card">âœ… <%= card.action %> -- Fait Ã  <%= format_time card.done_at %><br/>
                <% if defined?(display_card_links) && display_card_links %>
                  <%= public_card_link card %>
                <% end %>
              </li>
              <li class="dashboard__item--player-dead">ðŸ’€ <%= card.target.name %></li>
            <% end %>
          </ul>
        </details>
      <% end %>
      <%# nested ul %>
      <% if false && row[:cards].size > 0 %>
        <span><strong><%= row[:cards].size %></strong> kills <%= 'ðŸ’€' * row[:cards].size %></span>
        <ul>
          <% row[:cards].each do |card| %>
            <li class="card">âœ… <%= card.action %> -- Fait Ã  <%= format_time card.done_at %><br/>
              <% if defined?(display_card_links) && display_card_links %>
                <%= public_card_link card %>
              <% end %>
            </li>
            <li class="dashboard__item--player-dead"><%= card.target.name %></li>
          <% end %>
        </ul>
      <% end %>
    </li>
    <% if row[:cards].size > 0 %>
      <% row[:cards].each do |card| %>
        <li class="dashboard__item--action">
          <div class="card">
            <%= card.action %> -- Fait Ã  <%= format_time card.done_at %><br/>
            <% if defined?(display_card_links) && display_card_links %>
              <%= public_card_link card %>
            <% end %>
          </div>
        </li>
        <li class="dashboard__item--player-dead"><%= card.target.name %></li>
      <% end %>
    <% end %>
  </li>
  <li class="dashboard__item--action">
    <div class="card">
      <%= row[:current].action %>
    </div>
  </li>
<% end %>
</ul>
<hr/>
<ul class="dashboard2">
  <% dashboard.each do |row| %>
    <li>
      <%= render('games/dashboard2_player',
      row: row,
      readonly: defined?(readonly) && readonly,
      open_kills: defined?(open_kills) && open_kills,
    ) %>
      <% if row[:cards].size > 0 %>
        <details class="player-cards__actions-done" <%= 'open' if defined?(open_kills) && open_kills %>>
          <summary class="badge"><strong><%= row[:cards].size %></strong> kills <%= 'ðŸ’€' * row[:cards].size %></summary>
          <ul class="dashboard2">
            <% row[:cards].each do |card| %>
              <li>
                <div class="player-cards__action player-cards__action--done">
                  <p><%= card.action %> -- Fait Ã  <%= format_time card.done_at %></p>
                  <% if defined?(display_card_links) && display_card_links %>
                    <p><%= public_card_link card %></p>
                  <% end %>
                </div>
                <!-- dead player -->
                <div class="player-cards__player">
                  <p><%= card.target.name %></p>
                </div>
              </li>
            <% end %>
          </ul>
        </details>
      <% end %>
      <% if row[:current] %>
        <%# current is not set when user finished game %>
        <div class="player-cards__action">
          <p><%= row[:current].action %></p>
          <ul class="actions">
            <% if defined?(display_card_links) && display_card_links %>
              <li><%= public_card_link row[:current] %></li>
            <% end %>
            <% unless defined?(readonly) && readonly %>
              <li><%= edit_card_link row[:current] %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </li>
  <% end %>
  <%# display first player again %>
  <li><%= render('games/dashboard2_player',
      row: dashboard[0],
      readonly: defined?(readonly) && readonly,
      open_kills: defined?(open_kills) && open_kills,
    ) if dashboard.size > 1 %>
  </li>
</ul>
