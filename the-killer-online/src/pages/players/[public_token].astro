---
import Layout from "../../layouts/Layout.astro";
import { fetchGameBy, getGamePublicUrl } from "../../services/games";

import { fetchPlayerByPublicToken } from "../../services/players";

const player = await fetchPlayerByPublicToken(String(Astro.params.public_token));

if (!player) {
  return new Response("Game not found", {
    status: 404,
    statusText: "Not found",
  });
}

const game = await fetchGameBy("id", player.game_id);

const gamePublicUrl = getGamePublicUrl(game);

const title = `ðŸ‘‹ Hello ${player.name}`;
---

<Layout title={title}>
  <h1>{title}</h1>

  <p>You're part of the game: <a href={gamePublicUrl}>{game.name}</a></p>

  <a href="/">Go back</a>
</Layout>
 ../../services/players
